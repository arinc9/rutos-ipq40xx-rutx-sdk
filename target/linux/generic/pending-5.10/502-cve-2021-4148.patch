Linux kernel block_invalidatepage vulnerability [MEDIUM] - CVE-2021-4148
A vulnerability was found in the Linux kernel's block_invalidatepage in fs/buffer.c in the filesystem. 
A missing sanity check may allow a local attacker with user privilege to cause a denial of service (DOS) problem.
--- a/fs/buffer.c
+++ b/fs/buffer.c
@@ -1512,7 +1512,7 @@ void block_invalidatepage(struct page *p
 	/*
 	 * Check for overflow
 	 */
-	BUG_ON(stop > PAGE_SIZE || stop < length);
+	BUG_ON(stop > thp_size(page) || stop < length);
 
 	head = page_buffers(page);
 	bh = head;
@@ -1540,7 +1540,7 @@ void block_invalidatepage(struct page *p
 	 * The get_block cached value has been unconditionally invalidated,
 	 * so real IO is not possible anymore.
 	 */
-	if (length == PAGE_SIZE)
+	if (length >= PAGE_SIZE)
 		try_to_release_page(page, 0);
 out:
 	return;
