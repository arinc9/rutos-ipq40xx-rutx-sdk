{
  "openapi": "3.0.0",
  "tags": [
    {
      "name": "IPTables"
    }
  ],
  "paths": {
    "/firewall/iptables/ipv4/status": {
      "get": {
        "summary": "Returns all parsed chains and their rules from `iptables` command",
        "tags": [
          "IPTables"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200GetForIptables"
          }
        }
      },
      "parameters": [],
      "x-web": {
        "menu": ["Network", "Firewall", "IPv4"],
        "hw_tags": {
          "is_access_point": false,
          "is_switch": false
        }
      }
    },
    "/firewall/iptables/ipv6/status": {
      "get": {
        "summary": "Returns all parsed chains and their rules from `ip6tables` command",
        "tags": [
          "IPTables"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200GetForIptables"
          }
        }
      },
      "parameters": [],
      "x-web": {
        "menu": ["Network", "Firewall", "IPv6"],
        "hw_tags": {
          "is_access_point": false,
          "is_switch": false
        }
      }
    },
    "/firewall/iptables/ipv4/actions/reset": {
      "post": {
        "summary": "Resets `iptables` chains counters",
        "tags": [
          "IPTables"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200PostForIptables"
          }
        }
      },
      "parameters": [],
      "x-web": {
        "menu": ["Network", "Firewall", "IPv4"],
        "hw_tags": {
          "is_access_point": false,
          "is_switch": false
        }
      }
    },
    "/firewall/iptables/ipv6/actions/reset": {
      "post": {
        "summary": "Resets `ip6tables` chains counters",
        "tags": [
        "IPTables"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200PostForIptables"
          }
        }
      },
      "parameters": [],
      "x-web": {
        "menu": ["Network", "Firewall", "IPv6"],
        "hw_tags": {
          "is_access_point": false,
          "is_switch": false
        }
      }
    }
  },
  "components": {
    "responses": {
      "200GetForIptables": {
        "description": "Returns parsed iptables",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "description": "Operation status",
                  "type": "boolean"
                },
                "data": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/iptables_values"
                  }
                }
              }
            }
          }
        }
      },
      "200PostForIptables": {
        "description": "Resets iptables chains counters",
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "success": {
                  "description": "Operation status",
                  "type": "boolean"
                }
              }
            }
          }
        }
      }
    },
    "schemas": {
      "iptables_values": {
        "type": "object",
        "properties": {
          "table": {
            "type": "string",
            "description": "Table name"
          },
          "chains": {
            "type": "array",
            "description": "Table chains",
            "items": {
              "type": "object",
              "properties": {
                "chain": {
                  "type": "string"
                },
                "pkts": {
                  "type": "string"
                },
                "bytes": {
                  "type": "string"
                },
                "policy": {
                  "type": "string"
                },
                "rules": {
                  "type": "array",
                  "description": "Table chain rules",
                  "items": {
                    "type": "object",
                    "properties": {
                      "pkts": {
                        "type": "string"
                      },
                      "bytes": {
                        "type": "string"
                      },
                      "target": {
                        "type": "string"
                      },
                      "prot": {
                        "type": "string"
                      },
                      "in": {
                        "type": "string"
                      },
                      "out": {
                        "type": "string"
                      },
                      "source": {
                        "type": "string"
                      },
                      "destination": {
                        "type": "string"
                      },
                      "options": {
                        "type": "string"
                      },
                      "comment": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
